# Example: Adding a new service to Kong Gateway
# Step 1: Create the service
curl -X POST http://kong-admin-url:8001/services \
  --data "name=my-new-service" \
  --data "host=my-service.my-namespace.svc.cluster.local" \
  --data "port=8080"

# Step 2: Create the route
curl -X POST http://kong-admin-url:8001/services/my-new-service/routes \
  --data "hosts[]=digit-lts.digit.org" \
  --data "paths[]=/my-service"

# Step 3: Apply plugins
curl -X POST http://kong-admin-url:8001/routes/{route-id}/plugins \
  --data "name=dynamic-jwt"

curl -X POST http://kong-admin-url:8001/routes/{route-id}/plugins \
  --data "name=keycloak-rbac" \
  --data "config.allowed_roles[]=user,admin" 